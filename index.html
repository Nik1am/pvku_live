<head>
<title>pvku.tk | –ó–∞–≥—Ä—É–∑–∫–∞...</title>
<link rel="stylesheet" type="text/css" href="style.css">
</head>
<body>
<script type="text/javascript" src="shedule.js"></script> 
<script>
	var storage = window.localStorage;
	// [–¥–µ–Ω—å[–≥—Ä—É–ø–ø–∞[–º–∞—Å—Å–∏–≤ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è]]]
	var shedule = csv2json
	var title_str = ""
	//–°–∫—Ä—ã—Ç–∏–µ –∫–Ω–æ–ø–æ–∫ –ø—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –≤ –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω—ã–π —Ä–µ–∂–∏–º
	window.onresize = function(){
		hof = document.getElementsByClassName("hide-on-fullscreen")
			if( isFullScreen()) {
				for (i=0; i<hof.length; i++) {
    				hof[i].style.top = '-4em';
				}
			}
			else {
				for (i=0; i<hof.length; i++) {
    				hof[i].style.top = '0';
				}
			}
		};
	// –†–µ–∞–∫—Ü–∏—è –Ω–∞ –¥–≤–æ–π–Ω–æ–µ –Ω–∞–∂–∞—Ç–∏–µ –ø–æ —ç–∫—Ä–∞–Ω—É
	document.addEventListener('dblclick', (e) => {
		toggleFullScreen()
	});
	// –§—É–Ω–∫—Ü–∏—è –≤—Ö–æ–¥–∞/–≤—ã—Ö–æ–¥–∞ –∏–∑ –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞ (—É–∫—Ä–∞–ª –∏–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞)
	function toggleFullScreen() {
       if (!document.fullscreenElement &&    // alternative standard method
        !document.mozFullScreenElement && !document.webkitFullscreenElement) {  // current working methods
         if (document.documentElement.requestFullscreen) {
           document.documentElement.requestFullscreen();
         } else if (document.documentElement.mozRequestFullScreen) {
           document.documentElement.mozRequestFullScreen();
         } else if (document.documentElement.webkitRequestFullscreen) {
           document.documentElement.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT);
         }
       } else {
          if (document.cancelFullScreen) {
             document.cancelFullScreen();
          } else if (document.mozCancelFullScreen) {
             document.mozCancelFullScreen();
          } else if (document.webkitCancelFullScreen) {
            document.webkitCancelFullScreen();
          }
       }
     }
	window.onload = function() {
		// –§—É–Ω–∫—Ü–∏—è —Å–º–µ–Ω—ã —Å—Ç–µ–ø–µ–Ω–∏ —Ä–∞–∑–º—ã—Ç–∏—è —Ñ–æ–Ω–∞
		var bs = document.getElementById('blur-slider')
		bs.oninput = function() {
			document.getElementsByClassName('bg')[0].style.filter = `blur(${bs.value}px)`;
			storage.setItem('blur_strength',bs.value);
		}
		// –§—É–Ω–∫—Ü–∏—è —Å–º–µ–Ω–∞ –≥—Ä—É–ø–ø—ã
		var gs = document.getElementById('group-selector')

		for (var i = 0; i<shedule.length; i++){
    		var opt = document.createElement('option');
    		opt.value = i;
    		opt.innerHTML = shedule[i][0];
    		gs.appendChild(opt);
		}

		gs.onchange = function() {
			storage.setItem('group_id',gs.value);
			writeSchedule(gs.value)
		};
		
		// –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–ø–æ–ª–Ω–µ–Ω–∞ –ª–∏ —è—á–µ–π–∫–∞ —Å —Å—Å—ã–ª–∫–æ–π –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ñ–æ–Ω–∞, –µ—Å–ª–∏ –Ω–µ—Ç - —Å—Ç–∞–≤–∏—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π
		if(storage.getItem('bgurl') != null){
			document.getElementsByClassName('bg')[0].style.backgroundImage = "url("+storage.getItem('bgurl')+")";
			document.getElementById("bg-preview").src = storage.getItem('bgurl');
		} else {
			storage.setItem('bgurl',"https://i.pinimg.com/736x/db/86/4f/db864f597a08dc61666c9cee0b711972.jpg");
			document.getElementsByClassName('bg')[0].style.backgroundImage = "url("+storage.getItem('bgurl')+")";
		}

		// –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—ã–±—Ä–∞–Ω–∞ –ª–∏ –≥—Ä—É–ø–ø–∞, –µ—Å–ª–∏ –Ω–µ—Ç - —Ç–æ –≤—ã—Å—Ç–∞–≤–ª—è–µ—Ç id 0
		if(storage.getItem('group_id') != null){
			gs.selectedIndex = storage.getItem('group_id');
			writeSchedule(storage.getItem('group_id'));
		} else {
			storage.setItem('group_id',0);
		}

		// –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–ø–æ–ª–Ω–µ–Ω–∞ –ª–∏ —è—á–µ–π–∫–∞ —Å –∑–Ω–∞—á–µ–Ω–∏–µ–º —Ä–∞–∑–º—ã—Ç–∏—è —Ñ–æ–Ω–∞, –µ—Å–ª–∏ –Ω–µ—Ç - —Ç–æ —Å—Ç–∞–≤–∏—Ç 5 (px)
		if(storage.getItem('blur_strength') != null){
			document.getElementsByClassName('bg')[0].style.filter = `blur(${storage.getItem('blur_strength')}px)`
		} else {
			storage.setItem('blur_strength',5);
		}
		// –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª —Å–º–µ–Ω—ã —Ñ–æ–Ω–∞ v2
		bgFile = document.getElementById("bg-file");
		bgURL = document.getElementById("bg-url");
		bgBtn = document.getElementById("bg-btn");
		bgPreview = document.getElementById("bg-preview");
		var tempImageData;
		var reader = new FileReader();
		bgFile.onchange = () => {
        	reader.readAsDataURL(bgFile.files[0]); 
        	reader.onload = () => {
            	tempImageData = reader.result;
				bgPreview.src = tempImageData;
        	}
    	}
		bgURL.onblur = () => {
			bgPreview.src = bgURL.value;
		}
		bgBtn.onclick = () => {
			if(bgURL.value){
				bgPreview.src = bgURL.value;
				document.getElementsByClassName('bg')[0].style.backgroundImage = "url("+bgURL.value+")"; 
				storage.setItem('bgurl',bgURL.value);
			}
			else if(bgFile.value){
				bgPreview.src = tempImageData;
				document.getElementsByClassName('bg')[0].style.backgroundImage = "url("+tempImageData+")"; 
				storage.setItem('bgurl',tempImageData);
			}
			else{
				alert("–î–ª—è —Å–º–µ–Ω—ã —Ñ–æ–Ω–∞ –≤—ã–±–µ—Ä–∏—Ç–µ —Ö–æ—Ç—è-–±—ã 1 –≤–∞—Ä–∏–∞–Ω—Ç")
			}
		}
		// –ó–∞–ø—É—Å–∫ —á–∞—Å–æ–≤
		var x = setInterval(update, 1000)
	}
	// –§—É–Ω–∫—Ü–∏—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –æ—Ç–∫—Ä—ã—Ç –ª–∏ —Å–∞–π—Ç –≤–æ –≤–µ—Å—å —ç–∫—Ä–∞–Ω
	function isFullScreen() {
		return window.innerHeight == screen.height
	}
	// –§—É–Ω–∫—Ü–∏—è –Ω–∞–ø–∏—Å–∞–Ω–∏—è —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è –ø–æ id –≥—Ä—É–ø–ø—ã
	function writeSchedule(group_id) {
		var weekday = new Date().getDay()
		if (weekday == 0) {
			weekday = 7;
		}
		var temp = "";
		for (let i = 0; i < 4; i++) {
			para_name = shedule[group_id][weekday].split(";")[i]
			if (para_name){
				document.getElementsByClassName('lecture')[i].innerHTML = para_name
			}
			else {
				document.getElementsByClassName('lecture')[i].innerHTML = ""
			}
		}
	}

	// –§—É–Ω–∫—Ü–∏—è —Å–º–µ–Ω—ã —Ñ–æ–Ω–∞ [–£–°–¢–ê–†–ï–õ–ê]
	/*function changeBG() {
		var url = prompt('–°—Å—ã–ª–∫–∞ –Ω–∞ —Ñ–∞–π–ª —Ñ–æ–Ω–∞',storage.getItem('bgurl'))
		if(url != null){
			document.getElementsByClassName('bg')[0].style.backgroundImage = "url("+url+")"; 
			storage.setItem('bgurl',url);
		}
	}*/
	//–§—É–Ω–∫—Ü–∏—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏ —Ñ–æ—Ä–º–∞—Ç–∞ "–ß–ß:–ú–ú:–°–°" –≤ UNIX
	function t2u(str) {
		str_splitted = str.split(":")
		return new Date().setHours(str_splitted[0], str_splitted[1], str_splitted[2])
	}
	//–§—É–Ω–∫—Ü–∏—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏ —Ñ–æ—Ä–º–∞—Ç–∞ UNIX –≤ "–ß–ß:–ú–ú:–°–°"
	function u2t(unix) {
		unix -= 3*60*60*1000
		return nTo0n(new Date(unix).getHours())+":"+nTo0n(new Date(unix).getMinutes())+":"+nTo0n(new Date(unix).getSeconds())
	}
	//–§—É–Ω–∫—Ü–∏–∏ –ø–æ–∫–∞–∑–∞/—Å–∫—Ä—ã—Ç–∏—è –æ–∫–Ω–∞ —Å–º–µ–Ω—ã –≥—Ä—É–ø–ø—ã 
	function showChangeGroup() {
		let popup = document.getElementsByClassName('popup')[0]
		if (popup.style.scale != '0') {
			popup.style.scale  = '0'
			popup.style.opacity  = '0'
		}
		else {
			popup.style.scale  = '1'
			popup.style.opacity  = '1'
		}
	}
	//–§—É–Ω–∫—Ü–∏–∏ –ø–æ–∫–∞–∑–∞/—Å–∫—Ä—ã—Ç–∏—è —á–∞—Å–æ–≤
	function clockToggle() {
		let clock = document.getElementsByClassName("clock-box")[0]
		if (clock.style.scale != '0') {
			clock.style.scale  = '0'
			clock.style.opacity  = '0'
		}
		else {
			clock.style.scale  = '1'
			clock.style.opacity  = '1'
		}
	}
	//–§—É–Ω–∫—Ü–∏–∏ –ø–æ–∫–∞–∑–∞/—Å–∫—Ä—ã—Ç–∏—è –≤—ã–±–æ—Ä–∞ —Ñ–æ–Ω–∞
	function changeBG() {
		let styler = document.getElementById("styler")
		if (styler.style.scale != '1') {
			styler.style.scale  = '1'
			styler.style.opacity  = '1'
			clockToggle()
		}
		else {
			styler.style.scale  = '0'
			styler.style.opacity  = '0'
			clockToggle()
		}
	}
	//–¶–µ–ª–æ—á–∏—Å–µ–ª—å–Ω–æ–µ –¥–µ–ª–µ–Ω–∏–µ
	function div(val, by){
    		return (val - val % by) / by;
		}
	//–§—É–Ω–∫—Ü–∏—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è —á–∏—Å–µ–ª —Ñ–æ—Ä–º–∞—Ç–∞ "n" –≤ "0n"
	function nTo0n(int){
    	if (int > 9) {
    		return int;
  		} else return `0${int}`;
	};
	// –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è —á–∞—Å–æ–≤, –≤ –Ω–∞—á–∞–ª–µ –∏–∑-–∑–∞ –Ω–µ —Å—Ç–∞–±–∏–ª—å–Ω–æ–≥–æ API –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø–æ–ª—É—á–µ–Ω–∏–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑(–Ω—É–∂–Ω–æ –¥–ª—è —Ç–æ—á–Ω–æ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏)
	function update() {
		if (document.getElementById("myspan").childNodes[0].textContent == "notdiff"){
			fetch("https://worldtimeapi.org/api/timezone/Asia/Almaty")
				.then(response => response.json())
				.then(data => {
			try	{
				console.log(diff)
			}
			catch {
				diff = new Date() - Date.parse(data.datetime.slice(0,-6))
				console.log("–ê–ø–∏ –≥–æ–≤–Ω–æ "+diff)
				console.log("–¢–µ–∫—É—â–∞—è –¥–∞—Ç–∞ "+Date.parse(new Date())+new Date())
				console.log("–ê–ª–º–∞—Ç—ã "+Date.parse(data.datetime.slice(0,-6))+data.datetime)
				document.getElementById("myspan").innerHTML = diff
				document.body.style.cursor = "unset" 
			}
		})}
		let time_with_offset = new Date() - diff;
		index2para_name = [1,1,2,2,3,3,4,4,1,1,2,2,3,3,4,4]
		let b11 = t2u("08:00:00")
		let l11 = t2u("09:20:00")
		let b12 = t2u("09:30:00")
		let l12 = t2u("10:50:00")
		let b13 = t2u("11:10:00")
		let l13 = t2u("12:30:00")
		let b14 = t2u("12:40:00")
		let l14 = t2u("14:00:00")

		let b21 = t2u("12:40:00")
		let l21 = t2u("14:00:00")
		let b22 = t2u("14:10:00")
		let l22 = t2u("15:30:00")
		let b23 = t2u("15:30:00")
		let l23 = t2u("17:05:00")
		let b24 = t2u("17:15:00")
		let l24 = t2u("18:35:00")
		var weekday = new Date().getDay()
		if (weekday == 0) {
			weekday = 7;
		}
		
		var pars = [l24,b24,l23,b23,l22,b22,l21,b21,l14,b14,l13,b13,l12,b12,l11,b11]
		var times_to_pars = [];
		var current_para = 0
		pars.forEach((element, index) => {
			let dd = element-time_with_offset
			if(dd > 0){
				times_to_pars.push(dd)
			}
			console.log(`${dd} ${u2t(dd)}`)
			document.title = u2t(dd)
		})
		// forEach end
		timestr = u2t(Math.min(...times_to_pars))
		document.getElementById('clock').innerHTML = timestr
		document.title = timestr
		times_to_pars = []
		//document.getElementsByClassName('lecture')[current_para].innerHTML = shedule[storage.getItem('group_id')][weekday].split(";")[current_para] + " <"
	}
</script>


<div class="bg">
	<p id="myspan" class="hiden">notdiff</p>
</div>
<div class="hide-on-fullscreen">
	<div id="footer">
		–†–∞–∑–º—ã—Ç–∏–µ<input id="blur-slider" type="range" min="0" max="50" value="5">
	</div>
	<div>
		
	</div>
	<button id="btn-skin" onclick="changeBG()">üñåÔ∏è –§–æ–Ω</button>
	<button id="btn-group" onclick="showChangeGroup()">üë§ –ì—Ä—É–ø–ø–∞</button>
</div>
<div class="clock-box">
	<p class="dopari">–î–æ –Ω–∞—á–∞–ª–∞/–∫–æ–Ω—Ü–∞ –ø–∞—Ä—ã –æ—Å—Ç–∞–ª–æ—Å—å</p>
	<p id="clock">...</p>
</div>

<div class="popup">
	<div id="group-selector-title">–ì—Ä—É–ø–ø–∞: 
		<select id="group-selector">
		</select>
	</div>
	<div id="shedule">
		<p class="lecture"></p>
		<p class="lecture"></p>
		<p class="lecture"></p>
		<p class="lecture"></p>
	</div>
</div>
<div id="styler">
	–í—ã–±–æ—Ä —Ñ–æ–Ω–∞
	<div id="bg-url-wrapper">
		URL:<input id="bg-url">
	</div>
	<div id="bg-file-wrapper">
		<input id="bg-file" type="file" accept="image/*">
	</div>
	<div id="bg-btn-wrapper">
		<button id="bg-btn">–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–∞–∫ —Ñ–æ–Ω</button>
	</div>
	<div id="bg-preview-wrapper">
		<img id="bg-preview" src="https://cheems.ml/icon.png">
	</div>
</div>
</body>